# 悟空的官方插件

## LocalPlayer

本地音乐播放器。

### 触发条件

指令中包含 “本地音乐” 关键词。

### 常用指令

| 指令 | 相同指令  |  用途 |
| ---- | -------- | ----- |
| 播放本地音乐 | -    | 开始播放指定目录下的音乐。 |
| 下一首 | 下一首歌, 下首歌   | 切换到下一首歌。如果没有下一首歌，就回到列表中第一首歌 |
| 上一首 | 上一首歌，上首歌 | 切换到上一首歌。如果没有上一首歌，就跳到列表中最后一首歌 |
| 停止播放 | 结束播放/退出播放 | 停止播放音乐的播放 |
| 大声点   | 大声一点，调大音量  | 调大音量 |
| 小声点    | 小声一点，调小音量   | 调小音量  |

### 示例

- 用户：“播放本地音乐”
- 悟空：开始播放指定目录下的音乐

### 配置

``` yaml
## 本地音乐插件
LocalPlayer:
    path: "/Users/panweizhou/Music"  # 本地音乐存放路径
```

## Email

检查邮件功能。

### 触发条件

1. 用户已在 ~/.wukong/config.xml 中完成了邮箱的配置。
2. 指令中有关键词 “邮件” 。

语音播报的规则：
- 如果配置 `read_email_title` 选项为 `true`，会同时阅读邮件标题。如果为 `false`，则只阅读邮件的发件人信息。
- 如果邮件的标题带有 `[echo]` 的前缀，则不管 `read_email_title` 值为什么，都会阅读该邮件的标题，并且不会播报发件人信息（可利用该功能来实现传话、其他事件监控播报，例如与 ifttt 结合发布各类通知）。
- 如果邮件的标题带有 `[control]` 的前缀，且发件人是用户的邮箱，则将当成一条远程命令指令进行响应。

### 示例

- 用户：“我有多少封邮件？”
- 悟空：“您有一封来自 m at hahack.com 的未读邮件”

### 特别说明 ###

国内的一些邮件服务使用的是私有协议（例如 QQ 邮箱），所以 Email 插件是无法适用的。

目前测试比较好的是网易邮箱。如果使用网易邮箱，还需设置允许第三方客户端收发邮件：

?> <http://config.mail.163.com/settings/imap/index.jsp?uid=您的邮箱地址>

注意把链接中 `您的邮箱地址` 改为您真实的网易邮箱地址（带邮箱后缀）。

## Camera

用于调起摄像头拍照（如果安装了摄像头的话）。拍完后将在后台管理端的会话气泡中直接展示。

### 适用平台

适用于树莓派、带有USB摄像头的 PC 或者 Mac。

### 触发条件

指令中有关键词 “拍照” 或 “拍张照” 时。

如果接入了邮箱，照片将发送到用户的邮箱中。

### 示例

#### 倒计时拍照

- 用户：“拍张照”。
- 悟空：“收到，3秒后启动拍照……咔擦（拍照声）……拍照成功！正在发送照片到您的微信……发送成功！”

#### 无声拍照

- 用户：“偷偷地拍张照”（也可以使用微信发）。
- 悟空：“……（无声）”

### 配置

``` yaml
# 后台管理端
server:
    ...
    host: '0.0.0.0'  # 这里改成当前运行 wukong-robot 的设备的局域网地址
    ...

...

# 拍照
# 需接入摄像头才能使用
camera:
    enable: false
    type: 2                 # 摄像头类型 0：usb_camera，1：树莓派 5MP 摄像头，2：Mac 摄像头
                            # 对于 Mac 摄像头，请先安装 imagesnap 。例如 Mac OSX： brew install imagesnap
    dest_path: "/Users/panweizhou/Pictures/" # 保存目录
    quality: 5              # 成像质量（0~100），不支持 imagesnap
    vertical_flip: true     # 竖直翻转，不支持 imagesnap
    horizontal_flip: false  # 水平翻转，不支持 imagesnap
    count_down: 3           # 倒计时（秒），仅当开启倒计时时有效
    sound: true             # 是否有拍照音效
    usb_camera: false       # 是否是 USB 摄像头（已废弃，请使用 type）
```

如果是 USB 摄像头，还需要确保安装了 fswebcam ：

``` bash
sudo apt-get install fswebcam
```

如果是树莓派摄像头，请确保在 `raspi-config` 中已启用 Camera ：

![](https://images2015.cnblogs.com/blog/1174662/201705/1174662-20170531164041180-332981382.jpg)

如果是 Mac OSX 摄像头，则需要安装 imagesnap ：

``` bash
brew install imagesnap
```

## CleanCache

用于清除 wukong-robot 运行时产生的所有临时数据（包括语音缓存数据）

### 触发条件

指令中有关键词 “清除缓存” 或 “清空缓存”

### 示例

- 用户：“清除缓存”
- 悟空：“缓存目录已清空”

## Poem

让 wukong-robot 给你写一首诗

### 触发条件

指令中有关键词 “写诗”

### 示例

- 用户：“播放本地音乐”
- 悟空：“神州大海起风浪,诗友词坛聚一堂,我自天涯歌盛世,君从塞外写华章”
- 用户：“写诗”
- 悟空：“曾写诗行几度秋,酸甜苦辣共登楼,谁言此地无春色,我自吟哦乐不休”

## Echo

简单的回声/传话功能。

当借助 [wukong-itchat](https://github.com/wzpan/wukong-itchat) 接入微信时，可以利用这个功能实现远程给家里发语音消息。

### 触发条件

当检测到指令中包含 "echo" 或者 "传话" 时，将其余内容直接念出来。

### 示例

- 用户：“echo 你是最棒的”
- 悟空：“你是最棒的”

## Geek（极客模式） ##

类似 DuerOS 的极客模式。用于免唤醒实现和 wukong-robot 交互。当超过 5 轮用户没有说出指令时，自动结束极客模式。

!> 已知问题：Mac 中使用极客模式可能会有卡住的情况。原因是 PyAudio 在短时间内频繁进入录音时可能出现内存泄漏。如果遇到，需要重新启动 wukong-robot 。

### 触发条件

指令中含有关键词 “进入极客模式” 。

### 常用指令 ###

| 指令 | 相同指令  |  用途 |
| ---- | -------- | ----- |
| 进入极客模式 | 开启极客模式，激活极客模式，打开极客模式     | 进入极客模式  |
| 退出极客模式   | 结束极客模式，停止极客模式           | 退出极客模式。也可以保持一段时间不说指令，之后自动结束极客模式。     |

### 示例

- 用户：“进入极客模式”
- 悟空：“进入极客模式”
- 用户：“你叫什么名字”
- 悟空：“我叫悟空”
- 用户：“你爸爸是谁”
- 悟空：“我爸爸是潘伟洲”
- 用户：“退出极客模式”
- 悟空：“退出极客模式”


